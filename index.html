<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Supabase Real-Time Messages</title>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    ul { list-style: none; padding: 0; }
    li { padding: 4px 8px; border-bottom: 1px solid #ddd; }
    input { padding: 8px; width: 250px; }
    button { padding: 8px 12px; margin-left: 4px; }
  </style>
</head>
<body>
  <h2>Supabase Real-Time Messages</h2>

  <input id="msgInput" type="text" placeholder="Type a message..." />
  <button onclick="sendMessage()">Send</button>

  <ul id="messages"></ul>

  <script>
    // ðŸ”¹ Your Supabase credentials
    const SUPABASE_URL = "https://kyoskljfosvtlcjmrqwz.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt5b3NrbGpmb3N2dGxjam1ycXd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwODc0NzAsImV4cCI6MjA3NDY2MzQ3MH0.Fq8h5tVk2ZzDjigHX_Nc2g0HwhHUDau5GxjHtw75Vgs";
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const msgList = document.getElementById("messages");
    const msgInput = document.getElementById("msgInput");

    // Send message
    async function sendMessage() {
      const text = msgInput.value.trim();
      if (!text) return;
      await supabase.from("messages").insert([{ content: text }]);
      msgInput.value = "";
    }

    // Render message
    function addMessage(msg) {
      const li = document.createElement("li");
      li.textContent = `[${new Date(msg.inserted_at).toLocaleTimeString()}] ${msg.content}`;
      msgList.appendChild(li);
    }

    // Load old messages
    async function loadMessages() {
      const { data, error } = await supabase.from("messages").select("*").order("inserted_at");
      if (error) {
        console.error("Load error:", error.message);
        return;
      }
      data.forEach(addMessage);
    }
    loadMessages();

    // Real-time sync
    supabase
      .channel("public:messages")
      .on("postgres_changes", { event: "INSERT", schema: "public", table: "messages" }, (payload) => {
        addMessage(payload.new);
      })
      .subscribe();
  </script>
</body>
</html>